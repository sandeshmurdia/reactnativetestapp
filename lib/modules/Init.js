var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.data=exports.api_key=exports.Init=void 0;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _constants=require("../utils/constants");var _helper=require("../utils/helper");var _ContextualInfo=_interopRequireDefault(require("./ContextualInfo"));var _DeviceInformation=_interopRequireDefault(require("./DeviceInformation"));var _asyncStorage=_interopRequireDefault(require("@react-native-async-storage/async-storage"));var _Interceptor=_interopRequireDefault(require("./Interceptor"));var _ErrorHandling=_interopRequireDefault(require("./ErrorHandling"));var _AppState=_interopRequireDefault(require("./AppState"));var data=exports.data=null;var api_key=exports.api_key="";var Init=exports.Init=function(){var _ref=(0,_asyncToGenerator2.default)(function*(key){exports.api_key=api_key=key;try{var _data,_data$data;yield fetch(_constants.ZIPY_BASE_URL+"verify/"+key).then(function(response){return response.json();}).then(function(json){exports.data=data=json;}).catch(function(error){return console.error(error);});var sessionId=(0,_helper.generateSessionId)();yield _asyncStorage.default.setItem('session_id',`${sessionId}`);yield _asyncStorage.default.setItem('session_starttime',`${Date.now()}`);if((_data=data)!=null&&(_data$data=_data.data)!=null&&_data$data.logs_capture){yield(0,_DeviceInformation.default)();yield(0,_ContextualInfo.default)();(0,_AppState.default)();}}catch(error){console.error("[INIT] Error:",error);}(0,_ErrorHandling.default)();(0,_Interceptor.default)();console.log('zipy init working');});return function Init(_x){return _ref.apply(this,arguments);};}();